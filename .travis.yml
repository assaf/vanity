sudo: false
cache: bundler
language: ruby
bundler_args: --without development
script: 'bundle exec rake test'
services:
  - mongodb
  - redis-server
rvm:
- 1.9.3
- 2.0.0
- 2.1.0
- 2.2.0
- ruby-head
- jruby-1.7.13
- jruby-1.7.19
- jruby-head
env:
- DB=mongodb
- DB=redis
- DB=active_record
gemfile:
  - gemfiles/rails32.gemfile
  - gemfiles/rails4.gemfile
  - gemfiles/rails41.gemfile
  - gemfiles/rails42.gemfile
before_script:
- 'echo ''gem: --no-ri --no-rdoc'' > ~/.gemrc' # skip installing docs for gems
matrix:
  exclude:
    - rvm: 2.2.0
      gemfile: gemfiles/rails32.gemfile
    - rvm: ruby-head
      gemfile: gemfiles/rails32.gemfile
    - rvm: jruby-1.7.13
      gemfile: gemfiles/rails42.gemfile
    - rvm: jruby-1.7.19
      gemfile: gemfiles/rails42.gemfile
    - rvm: jruby-head
      gemfile: gemfiles/rails42.gemfile
  allow_failures:
    - rvm: ruby-head
    - rvm: jruby-head
